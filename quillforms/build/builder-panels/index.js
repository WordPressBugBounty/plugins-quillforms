(()=>{"use strict";var e={d:(n,r)=>{for(var t in r)e.o(r,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:r[t]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};e.r(n),e.d(n,{registerBuilderPanel:()=>C,registerBuilderSubPanel:()=>D});var r={};e.r(r),e.d(r,{registerBuilderPanel:()=>f,registerBuilderSubPanel:()=>m,setCurrentPanel:()=>d,setCurrentSubPanel:()=>c});var t={};e.r(t),e.d(t,{getAreaToShow:()=>F,getCurrentPanel:()=>B,getCurrentPanelName:()=>w,getCurrentPanelType:()=>E,getCurrentSubPanel:()=>N,getCurrentSubPanelName:()=>x,getPanelByName:()=>v,getPanels:()=>h,getParentPanels:()=>S,getVisiblePanels:()=>T});const s=window.wp.data,a=window.lodash,l="REGISTER_BUILDER_PANEL",o="REGISTER_BUILDER_SUBPANEL",i="SET_CURRENT_PANEL",u="SET_CURRENT_SUBPANEL",p={panels:[],currentPanel:"",currentSubPanel:void 0,areaToShow:void 0},d=e=>({type:i,panelName:e}),c=e=>({type:u,subPanelName:e}),f=(e,n)=>({type:l,settings:n,name:e}),m=(e,n,r)=>({type:o,settings:n,parent:r,name:e});var b={};function g(e){return[e]}function P(e,n,r){var t;if(e.length!==n.length)return!1;for(t=r;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}function y(e,n){var r,t=n||g;function s(){r=new WeakMap}function a(){var n,s,a,l,o,i=arguments.length;for(l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];for(n=function(e){var n,t,s,a,l,o=r,i=!0;for(n=0;n<e.length;n++){if(!(l=t=e[n])||"object"!=typeof l){i=!1;break}o.has(t)?o=o.get(t):(s=new WeakMap,o.set(t,s),o=s)}return o.has(b)||((a=function(){var e={clear:function(){e.head=null}};return e}()).isUniqueByDependants=i,o.set(b,a)),o.get(b)}(o=t.apply(null,l)),n.isUniqueByDependants||(n.lastDependants&&!P(o,n.lastDependants,0)&&n.clear(),n.lastDependants=o),s=n.head;s;){if(P(s.args,l,1))return s!==n.head&&(s.prev.next=s.next,s.next&&(s.next.prev=s.prev),s.next=n.head,s.prev=null,n.head.prev=s,n.head=s),s.val;s=s.next}return s={val:e.apply(null,l)},l[0]=null,s.args=l,n.head&&(n.head.prev=s,s.next=n.head),n.head=s,s.val}return a.getDependants=t,a.clear=s,s(),a}const h=y((e=>e.panels),(e=>[e.panels.length])),S=y((e=>(0,a.filter)(e.panels,(e=>"parent"===e.mode))),(e=>[e.panels.length])),v=(e,n)=>h(e).find((e=>e.name===n)),T=y((e=>e.panels.filter((e=>!0!==e.isHidden))),(e=>[e.panels.length]));function w(e){return e.currentPanel}const B=y((e=>{const n=w(e);if(n)return(0,a.find)(e?.panels,(e=>e.name===n))}),(e=>[e?.panels.length,e?.currentPanel])),N=y((e=>{const n=B(e);if(e.currentSubPanel&&n)return n?.subPanels?.find((n=>n.name===e.currentSubPanel))}),(e=>[e?.panels.length,e?.currentSubPanel,e?.currentPanel]));function E(e){const n=B(e);return n?.type}function x(e){return e.currentSubPanel}function F(e){return B(e)?.areaToShow}const R=(0,s.createReduxStore)("quillForms/builder-panels",{actions:r,selectors:t,reducer:(e=p,n)=>{switch(n.type){case l:{const r=n.name;if((0,a.some)(e.panels,(e=>e.name===r)))return e;const t=n.settings;return{...e,panels:[...e.panels,{...t,name:r}]}}case o:{const{parent:r}=n,t=(0,a.findIndex)(e.panels,(e=>e.name===r));if(-1===t||"parent"!==e.panels[t].mode)return e;let s=e.panels[t].subPanels;s||(s=[]),s.push({...n.settings,name:n.name});const l=e.panels;return l[t].subPanels=s,{...e,panels:l}}case i:return n.panelName&&!(0,a.some)(e.panels,(e=>e.name===n.panelName))?e:{...e,currentPanel:n.panelName};case u:{if(!e.currentPanel)return e;const r=e.panels.find((n=>n.name===e.currentPanel));return r&&(0,a.some)(r.subPanels,(e=>e.name===n.subPanelName))?{...e,currentSubPanel:n.subPanelName}:e}}return e}});(0,s.register)(R);const q=window.qf.utils,_=window.wp.hooks,C=(e,n)=>{if(n=(0,_.applyFilters)("QuillForms.BuilderPanels.PanelSettings",n,e),"string"!=typeof e)return void console.error('Builder panel "name" must be string.');"string"!=typeof n.type&&(n.type="modal");const r=(0,s.select)("quillForms/builder-panels").getPanels();if((0,a.some)(r,(n=>n.name===e)))console.error(`The panel ${e} is already registered`);else if(n.title)if("string"==typeof n.title)if(n.isHidden&&"boolean"!=typeof n.isHidden)console.error('The "isHidden" property must be boolean');else if(!n.position||"number"==typeof n.position||n.isHidden)if(0===n.position||n.position||(n.position=10),n.icon=(0,q.normalizeIconObject)(n.icon),(0,q.isValidIcon)(n.icon.src))if("parent"!==n.mode&&(n.mode="single"),"single"!==n.mode||n.render){if(!n.render||(0,a.isFunction)(n.render))return n=(0,a.pick)(n,["icon","title","render","isHidden","mode","position","type"]),(0,s.dispatch)("quillForms/builder-panels").registerBuilderPanel(e,n),n;console.error("The 'render' property must be a valid function")}else console.error('The "render" property should be defined in case of single panels');else console.error('The "icon" property must be a valid function!');else console.error('The "position" property must be a number');else console.error('Builder panel "title" must be string.');else console.error("The 'title' property must be passed")},D=(e,n)=>{if(n=(0,_.applyFilters)("QuillForms.BuilderPanels.SubPanelSettings",n,e),"string"!=typeof e)return void console.error("Builder subpanel names must be strings.");const r=e.match(/^([a-z][a-z0-9-]*)\/[a-z][a-z0-9-]*$/);if(!r||!r[1])return void console.error("Builder subpanel name must contain the parent namespace prefix. Example: parent-panel/subpanel-panel");const t=r[1],l=(0,s.select)("quillForms/builder-panels").getParentPanels();if((0,a.some)(l,(e=>e.name===t)))if(n.title)if("string"==typeof n.title)if(n.render)if((0,a.isFunction)(n.render)){if(!n.position||"number"==typeof n.position)return 0===n.position||n.position||(n.position=10),n=(0,a.pick)(n,["title","render","position"]),(0,s.dispatch)("quillForms/builder-panels").registerBuilderSubPanel(e,n,t),n;console.error('The "position" property must be a number')}else console.error("The 'render' property must be a valid function");else console.error("The 'render' property is mandatory");else console.error("The 'title' property must be a string");else console.error("The 'title' property must be passed");else console.error(`Builder sub panel parent ${t} isn't registered. Please register it first!`)};(window.qf=window.qf||{}).builderPanels=n})();